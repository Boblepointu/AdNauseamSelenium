version: '3.8'

# Common environment for all browser nodes (disable telemetry spam)
x-node-common: &node-common-env
  SE_OTEL_TRACES_EXPORTER: none
  SE_ENABLE_TRACING: false

volumes:
  personas-data:
    driver: local

services:
  # Selenium Hub with increased capacity
  selenium-hub:
    image: selenium/hub:latest
    ports:
      - "4444:4444"
    environment:
      - SE_SESSION_REQUEST_TIMEOUT=300
      - SE_NODE_SESSION_TIMEOUT=300
      - SE_NODE_MAX_SESSIONS=25
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
      - SE_SESSION_TIMEOUT=300

  # ============================================
  # CHROME NODES (Diverse versions for maximum TLS/HTTP/CSS diversity)
  # ============================================
  
  chrome-95:
    image: selenium/node-chrome:95.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-110:
    image: selenium/node-chrome:110.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-120:
    image: selenium/node-chrome:120.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-125:
    image: selenium/node-chrome:125.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-130:
    image: selenium/node-chrome:130.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-latest:
    image: selenium/node-chrome:latest
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-beta:
    image: selenium/node-chrome:beta
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  chrome-dev:
    image: selenium/node-chrome:dev
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  # ============================================
  # FIREFOX NODES (Diverse versions)
  # ============================================

  firefox-98:
    image: selenium/node-firefox:98.0
    depends_on:
      - selenium-hub
    ports:
      - "7900:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-110:
    image: selenium/node-firefox:110.0
    depends_on:
      - selenium-hub
    ports:
      - "7901:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-120:
    image: selenium/node-firefox:120.0
    depends_on:
      - selenium-hub
    ports:
      - "7902:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-130:
    image: selenium/node-firefox:130.0
    depends_on:
      - selenium-hub
    ports:
      - "7903:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-140:
    image: selenium/node-firefox:140.0
    depends_on:
      - selenium-hub
    ports:
      - "7904:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-latest:
    image: selenium/node-firefox:latest
    depends_on:
      - selenium-hub
    ports:
      - "7905:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-beta:
    image: selenium/node-firefox:beta
    depends_on:
      - selenium-hub
    ports:
      - "7906:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  firefox-dev:
    image: selenium/node-firefox:dev
    depends_on:
      - selenium-hub
    ports:
      - "7907:7900"
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  # ============================================
  # EDGE NODES (Diverse versions)
  # ============================================

  edge-114:
    image: selenium/node-edge:114.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  edge-120:
    image: selenium/node-edge:120.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  edge-125:
    image: selenium/node-edge:125.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  edge-130:
    image: selenium/node-edge:130.0
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  edge-latest:
    image: selenium/node-edge:latest
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  edge-beta:
    image: selenium/node-edge:beta
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  edge-dev:
    image: selenium/node-edge:dev
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  # ============================================
  # CHROMIUM NODES (Only 'latest' actually exists!)
  # ============================================

  chromium-latest:
    image: selenium/node-chromium:latest
    depends_on:
      - selenium-hub
    environment:
      - SE_EVENT_BUS_HOST=selenium-hub
      - SE_EVENT_BUS_PUBLISH_PORT=4442
      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443
      - SE_NODE_MAX_SESSIONS=2
      - SE_OTEL_TRACES_EXPORTER=none
      - SE_ENABLE_TRACING=false
    shm_size: 2gb

  # REMOVED: chromium-beta and chromium-dev (they don't exist!)
  # If you need more Chromium diversity, just add more Chrome versions instead

  # ============================================
  # BROWSER AUTOMATION INSTANCES (20 instances)
  # ============================================

  # Instance 1 - Chrome variants
  browser-automation-1:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-95
      - chrome-110
      - chrome-120
      - chrome-latest
      - firefox-98
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 2 - Firefox variants
  browser-automation-2:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - firefox-110
      - firefox-120
      - firefox-130
      - firefox-140
      - firefox-latest
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 3 - Edge variants
  browser-automation-3:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - edge-114
      - edge-120
      - edge-125
      - edge-130
      - edge-latest
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 4 - Chromium and Beta/Dev channels (FIXED: removed chromium beta/dev)
  browser-automation-4:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chromium-latest
      - chrome-beta
      - chrome-dev
      - firefox-beta
      - firefox-dev
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 5 - Mixed browsers (all types)
  browser-automation-5:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-125
      - chrome-130
      - edge-beta
      - edge-dev
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 6 - Chrome mix 1
  browser-automation-6:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-95
      - chrome-125
      - firefox-130
      - edge-125
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 7 - Firefox mix 1
  browser-automation-7:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - firefox-98
      - firefox-140
      - chrome-120
      - edge-130
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 8 - Edge mix 1
  browser-automation-8:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - edge-114
      - edge-latest
      - chrome-110
      - firefox-120
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 9 - Beta/Dev channels mix
  browser-automation-9:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-beta
      - firefox-beta
      - edge-beta
      - chromium-latest
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 10 - Latest versions mix
  browser-automation-10:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-latest
      - firefox-latest
      - edge-latest
      - chrome-130
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 11 - Chrome mix 2
  browser-automation-11:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-110
      - chrome-120
      - firefox-110
      - edge-120
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 12 - Firefox mix 2
  browser-automation-12:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - firefox-120
      - firefox-130
      - chrome-95
      - edge-114
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 13 - Dev channels focus
  browser-automation-13:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-dev
      - firefox-dev
      - edge-dev
      - chrome-125
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 14 - Chrome older versions
  browser-automation-14:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-95
      - chrome-110
      - firefox-98
      - firefox-110
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 15 - Chrome newer versions
  browser-automation-15:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-125
      - chrome-130
      - firefox-140
      - edge-130
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 16 - Balanced mix 1
  browser-automation-16:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-120
      - firefox-120
      - edge-120
      - chromium-latest
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 17 - Balanced mix 2
  browser-automation-17:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-110
      - firefox-130
      - edge-125
      - chrome-beta
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 18 - All Firefox focus
  browser-automation-18:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - firefox-98
      - firefox-110
      - firefox-beta
      - firefox-dev
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 19 - All Edge focus
  browser-automation-19:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - edge-114
      - edge-120
      - edge-beta
      - edge-dev
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh

  # Instance 20 - Ultimate mix (all browser types)
  browser-automation-20:
    image: python:3.11-slim
    depends_on:
      - selenium-hub
      - chrome-latest
      - firefox-latest
      - edge-latest
      - chromium-latest
      - chrome-beta
    volumes:
      - ./crawl.py:/app/crawl.py:ro
      - ./persona_manager.py:/app/persona_manager.py:ro
      - ./setup.sh:/app/setup.sh:ro
      - ./websites.txt:/app/websites.txt:ro
      - personas-data:/app/data/personas
    environment:
      - PERSONA_ROTATION_STRATEGY=weighted
      - PERSONA_MAX_AGE_DAYS=30
      - PERSONA_MAX_USES=100
    command:
      - /bin/bash
      - -c
      - |
        apt-get update -qq && apt-get install -y curl -qq
        bash /app/setup.sh